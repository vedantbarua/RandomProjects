<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>LeetCode POC</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <style>
        body {
            background: radial-gradient(circle at top, #f2f7ff 0%, #f8fafc 60%, #ffffff 100%);
        }
        .summary-card {
            border: 0;
            box-shadow: 0 14px 35px rgba(15, 23, 42, 0.08);
        }
        .problem-card {
            border: 1px solid rgba(148, 163, 184, 0.3);
            border-radius: 18px;
        }
        .badge-easy { background: #16a34a; }
        .badge-medium { background: #f59e0b; }
        .badge-hard { background: #ef4444; }
        .badge-status-todo { background: #94a3b8; }
        .badge-status-in-progress { background: #2563eb; }
        .badge-status-solved { background: #10b981; }
    </style>
</head>
<body>
<div class="container py-5">
    <div class="d-flex flex-column flex-lg-row justify-content-between align-items-lg-center gap-3 mb-4">
        <div>
            <h1 class="display-6 fw-bold">LeetCode POC</h1>
            <p class="text-secondary mb-0">Track problems, attempts, and progress in one workspace.</p>
        </div>
        <a class="btn btn-dark btn-lg" href="/new">Add problem</a>
    </div>

    <div class="row g-3 mb-4">
        <div class="col-md-3">
            <div class="card summary-card p-3">
                <div class="text-uppercase text-secondary small">Total Problems</div>
                <div class="fs-2 fw-semibold" th:text="${summary.totalProblems}">4</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card summary-card p-3">
                <div class="text-uppercase text-secondary small">Solved</div>
                <div class="fs-2 fw-semibold" th:text="${summary.solvedProblems}">1</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card summary-card p-3">
                <div class="text-uppercase text-secondary small">In Progress</div>
                <div class="fs-2 fw-semibold" th:text="${summary.inProgressProblems}">2</div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card summary-card p-3">
                <div class="text-uppercase text-secondary small">Avg Minutes</div>
                <div class="fs-2 fw-semibold">
                    <span th:text="${#numbers.formatDecimal(summary.averageMinutes, 1, 1)}">35.0</span>
                </div>
            </div>
        </div>
    </div>

    <div class="card summary-card p-4 mb-4">
        <form method="get" action="/" class="row g-3 align-items-end">
            <div class="col-md-3">
                <label class="form-label text-secondary">Status</label>
                <select class="form-select" name="status">
                    <option value="">All</option>
                    <option th:each="status : ${statuses}"
                            th:value="${status}"
                            th:text="${status.label}"
                            th:selected="${statusFilter} == ${status}">In progress</option>
                </select>
            </div>
            <div class="col-md-3">
                <label class="form-label text-secondary">Difficulty</label>
                <select class="form-select" name="difficulty">
                    <option value="">All</option>
                    <option th:each="difficulty : ${difficulties}"
                            th:value="${difficulty}"
                            th:text="${difficulty.label}"
                            th:selected="${difficultyFilter} == ${difficulty}">Easy</option>
                </select>
            </div>
            <div class="col-md-4">
                <label class="form-label text-secondary">Tag</label>
                <input class="form-control" type="text" name="tag" placeholder="dp, graph, arrays" th:value="${tagFilter}">
            </div>
            <div class="col-md-2 d-grid">
                <button class="btn btn-outline-dark" type="submit">Filter</button>
            </div>
        </form>
    </div>

    <div class="d-flex align-items-center justify-content-between mb-3">
        <h2 class="h4 mb-0">Problem Board</h2>
        <span class="text-secondary" th:text="${summary.totalAttempts + ' total attempts'}">6 total attempts</span>
    </div>

    <div class="row g-3" th:if="${!problems.isEmpty()}">
        <div class="col-12" th:each="problem : ${problems}">
            <div class="p-4 bg-white problem-card">
                <div class="d-flex flex-column flex-lg-row justify-content-between gap-3">
                    <div>
                        <div class="d-flex flex-wrap align-items-center gap-2">
                            <span class="badge text-white" th:classappend="${problem.difficulty.badgeClass}" th:text="${problem.difficulty.label}">Easy</span>
                            <span class="badge text-white"
                                  th:classappend="${problem.status == T(com.randomproject.leetcode.ProblemStatus).TODO ? 'badge-status-todo' : (problem.status == T(com.randomproject.leetcode.ProblemStatus).IN_PROGRESS ? 'badge-status-in-progress' : 'badge-status-solved')}"
                                  th:text="${problem.status.label}">To do</span>
                            <span class="badge bg-light text-dark border" th:if="${problem.slug != null}" th:text="${problem.slug}">two-sum</span>
                        </div>
                        <h3 class="h5 mt-2 mb-1" th:text="${problem.title}">Two Sum</h3>
                        <div class="text-secondary small">
                            <span th:text="${problem.tags.isEmpty() ? 'No tags yet' : #strings.listJoin(problem.tags, ', ')}">arrays, hash map</span>
                        </div>
                        <p class="text-secondary small mt-2" th:if="${problem.notes != null}" th:text="${problem.notes}">
                            Keep track of corner cases.
                        </p>
                    </div>
                    <div class="text-lg-end">
                        <div class="fw-semibold">Attempts: <span th:text="${problem.attemptCount}">2</span></div>
                        <div class="text-secondary small" th:if="${problem.lastAttemptedOn != null}" th:text="'Last try: ' + ${problem.lastAttemptedOn}">Last try: 2024-01-01</div>
                        <div class="text-secondary small" th:if="${problem.lastAttemptedOn == null}">No attempts yet</div>
                        <a class="btn btn-outline-dark btn-sm mt-2" th:href="@{'/problem/' + ${problem.id}}">View details</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="alert alert-light" th:if="${problems.isEmpty()}">
        No problems yet. Add a new one to start tracking.
    </div>
</div>
</body>
</html>
